<script>
    // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
    const CONFIG = {
        INITIAL_STARS: 30,
        MAX_STAR_SIZE: 6,
        MIN_STAR_SIZE: 2,
        BACKGROUND_STARS: 150,
        GOOGLE_FORM_URL: "https://docs.google.com/forms/d/e/1FAIpQLSd3D5ypAsFGGBfoWOAlC1230iqpuaXgvyICj43VbYReOZfNuw/viewform?pli=1",
        VALUE_COLORS: {
            '–£–≤–∞–∂–µ–Ω–∏–µ': '#ff6666',
            '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å': '#6699ff',
            '–î—Ä—É–∂–±–∞': '#ff9900',
            '–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å': '#32cd32',
            '–°–ø–æ—Ä—Ç': '#9370db',
            '–î—Ä—É–≥–æ–π': '#ffdd00',
            '–°–≤–æ–±–æ–¥–∞': '#ff69b4',
            '–î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç': '#00ced1',
            '–î–µ–Ω—å–≥–∏': '#ff8c00'
        }
    };
    
    // –î–ê–ù–ù–´–ï –ò–ó GOOGLE FORMS (Excel —Ç–∞–±–ª–∏—Ü—ã)
    const GOOGLE_FORM_DATA = [
        {name: "–ú–∞—Ç–≤–µ–π", class: "6", value: "–°–≤–æ–±–æ–¥–∞", reason: ""},
        {name: "–ú–∞—Ç–≤–µ–π", class: "6", value: "–£–≤–∞–∂–µ–Ω–∏–µ", reason: ""},
        {name: "–°–í–ï–¢–ê", class: "11", value: "–°–≤–æ–±–æ–¥–∞", reason: "–°–≤–æ–±–æ–¥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Ç—å —Å–æ–±–æ–π!"},
        {name: "–ê—Ä—Ç–µ–º–∏–π", class: "10", value: "–î—Ä—É–∂–±–∞", reason: "–û–Ω–∞ —Å–æ–∑–¥–∞—ë—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –Ω–∞ –¥–∞–ª—å–Ω–µ–π—à—É—é –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É—á–∞—â–∏—Ö—Å—è –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏—Ö –ª–∏—á–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏"},
        {name: "–ú–∞—Ä–∏—è", class: "10", value: "–î—Ä—É–∂–±–∞", reason: "–û–Ω–∞ –¥–µ–ª–∞–µ—Ç –º–µ–Ω—è —Å—á–∞—Å—Ç–ª–∏–≤–µ–µ"},
        {name: "–î–µ–º–∏–¥", class: "6", value: "–î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç", reason: "–Ø –ª—é–±–ª—é –¥–µ–Ω—å–≥–∏ –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –¥–∞—é—Ç –º–Ω–æ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–πüëç"},
        {name: "–ê–Ω–¥—Ä–µ–π", class: "6", value: "–°–ø–æ—Ä—Ç", reason: "–Ø –º–Ω–æ–≥–æ –ª–µ—Ç –∑–∞–Ω–∏–º–∞—é—Å—å —Å–ø–æ—Ä—Ç–æ–º"},
        {name: "–°–∞—à–∞", class: "11", value: "–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å", reason: ""},
        {name: "–í–∏–∫–∞", class: "7", value: "–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", reason: "–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–º –¥–æ–≤–µ—Ä–∏—è –∏ –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–æ—Å—è—Ç —Ä–µ–∞–ª—å–Ω—É—é –ø–æ–ª—å–∑—É."},
        {name: "–ú–∞—Ä–∏—è –í.", class: "7", value: "–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å", reason: "–¢–∞–∫ –∫–∞–∫ –Ω–∞ –Ω–µ–π –¥–æ–ª–∂–Ω—ã —Å—Ç—Ä–æ–∏—Ç—å—Å—è —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞"},
        {name: "–õ–∏–∑–∞ –ù–∏–∫–∏—Ñ–æ—Ä–æ–≤–∞", class: "7", value: "–°–≤–æ–±–æ–¥–∞", reason: ""},
        {name: "–í–∞–¥–∏–º", class: "7", value: "–î—Ä—É–∂–±–∞", reason: "–ë–µ–∑ –¥—Ä—É–∂–±—ã –Ω–µ –±—É–¥–µ—Ç –¥—Ä—É–≥–∏—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π —Ç–∞–∫–∏—Ö –∫–∞–∫ —É–≤–∞–∂–µ–Ω–∏–µ –∏–ª–∏ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å"},
        {name: "–Ø—Ä–æ—Å–ª–∞–≤", class: "7", value: "–°–≤–æ–±–æ–¥–∞", reason: "–°–≤–æ–±–æ–¥–∞ —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–æ–π –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π"},
        {name: "—Ç–∏–º—É—Ä", class: "7", value: "–î—Ä—É–∂–±–∞", reason: "–¥—Ä—É–∑—å—è –≤—Å–µ–≥–¥–∞ –ø–æ–º–æ–≥—É—Ç"},
        {name: "–ü–µ—Ç—Ä–æ–≤–∞ –í–∞–ª–µ—Ä–∏—è", class: "7", value: "–î—Ä—É–∂–±–∞", reason: "–í–∞–∂–Ω–æ –∏–º–µ—Ç—å –¥—Ä—É–∑–µ–π –∏ —Ç–æ–≤–∞—Ä–∏—â–µ–π, –≤–µ–¥—å –≤ —ç—Ç–æ–º –ª–µ–∂–∏—Ç –æ—Å–Ω–æ–≤–∞ —É—Å–ø–µ—Ö–∞."},
        {name: "–î–∞–Ω–∏–∏–ª –ñ–µ–≥–∞–ª–∏–Ω", class: "7", value: "–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", reason: "–ü–æ—Ç–æ–º—É —á—Ç–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å - —ç—Ç–æ –∫–æ–≥–¥–∞ –∫—Ç–æ - —Ç–æ –æ–±—è–∑—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å —á–∞—Å—Ç—å –∑–∞–¥–∞—á, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –¥—Ä—É–≥–æ–π. –ë–µ–∑ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–µ –±—ã–ª–æ –±—ã —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –º–∏—Ä–∞."},
        {name: "–°–æ—Ñ–∏—è –ö–∞–π—Ç–º–∞–∑–æ–≤–∞ ‚≠êÔ∏è", class: "7", value: "–£–≤–∞–∂–µ–Ω–∏–µ", reason: "–£–≤–∞–∂–µ–Ω–∏–µ —Ä–æ–∂–¥–∞–µ—Ç –∏–¥–µ—é, –ø–æ–ª–µ–∑–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä –∏–ª–∏ –ø—Ä–∏—è—Ç–Ω—É—é –≤—Å—Ç—Ä–µ—á—É. –û–Ω–æ —Ä–æ–∂–¥–∞–µ—Ç –≤—Å–µ, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –æ–±—â–µ–Ω–∏–µ–º ‚Äî –∏ —ç—Ç–æ –≤–∞–∂–Ω–æ."},
        {name: "–ê–Ω–¥—Ä–µ–π", class: "6", value: "–°–ø–æ—Ä—Ç", reason: "–ü–æ—Ç–æ–º—É —á—Ç–æ —è –æ—á–µ–Ω—å —á–∞—Å—Ç–æ –∑–∞–Ω–∏–º–∞—é—Å—å —Å–ø–æ—Ä—Ç–æ–º –∏ —è –µ–≥–æ –ª—é–±–ª—é"},
        {name: "–ì–µ–æ—Ä–≥–∏–π", class: "7", value: "–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", reason: "–ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –æ–ø—ã—Ç —Å —Å–∞–º–æ–≥–æ –¥–µ—Ç—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä—ã–π –≤ –ë—É—à–µ–º –ø–æ–º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ª–∏–¥–µ—Ä–æ–º"},
        {name: "–ì–µ–æ—Ä–≥–∏–π", class: "7", value: "–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", reason: "–ü–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –æ–ø—ã—Ç —Å —Å–∞–º–æ–≥–æ –¥–µ—Ç—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä—ã–π –≤ –±—É–¥—É—â–µ–º –ø–æ–º–æ–∂–µ—Ç  —Å—Ç–∞—Ç—å –ª–∏–¥–µ—Ä–æ–º"},
        {name: "–°–≤–µ—Ç–∞", class: "11", value: "–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å", reason: ""},
        {name: ".", class: "8", value: "–°–≤–æ–±–æ–¥–∞", reason: ""},
        {name: "–õ–µ—à–∞", class: "8", value: "–î—Ä—É–∂–±–∞", reason: "–ü–æ—Ç–æ–º—É —á—Ç–æ –¥—Ä—É–∑—å—è –¥–ª—è –º–µ–Ω—è –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã"},
        {name: "–õ—É–∫–∞", class: "8", value: "–î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç", reason: ""},
        {name: "–í–∞—Ä—è", class: "8", value: "–£–≤–∞–∂–µ–Ω–∏–µ", reason: "–µ—Å–ª–∏ –º—ã –±—É–¥–µ–º –≤—Å–µ —É–≤–∞–∂–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞ —Ç–æ –≤—Å–µ –±—É–¥–µ—Ç —É—Ä–∞–≤–Ω–æ–≤–µ—à–µ–Ω–Ω–æ –∏ —Å–ø–æ–∫–æ–π–Ω–æ"},
        {name: "–©–µ–≥–ª–æ–≤ –ü–∞–≤–µ–ª", class: "8", value: "–î—Ä—É–∂–±–∞", reason: "–ü–æ–º–æ–≥–∞–µ—Ç –≤ –∂–∏–∑–Ω–∏"},
        {name: "–©–µ–≥–ª–æ–≤ –ü–∞–≤–µ–ª", class: "8", value: "–î—Ä—É–∂–±–∞", reason: "–ü–æ–º–æ–≥–∞–µ—Ç –≤ –∂–∏–∑–Ω–∏"}
    ];
    
    // –≠–ª–µ–º–µ–Ω—Ç—ã
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const tooltip = document.getElementById('tooltip');
    
    // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    let stars = [];
    let userStars = JSON.parse(localStorage.getItem('gymnasiumValues')) || [];
    let googleFormStars = [];
    let particles = [];
    let hoveredStar = null;
    let devicePixelRatio = Math.max(window.devicePixelRatio || 1, 1); // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –º–∏–Ω–∏–º—É–º 1
    let touchTimer = null;
    let animationFrameId = null;
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    function init() {
        console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—á–∞–ª–∞—Å—å');
        try {
            setupCanvas();
            createStars(CONFIG.INITIAL_STARS);
            createBackgroundStars(CONFIG.BACKGROUND_STARS);
            loadUserStars();
            loadGoogleFormStars();
            
            // –°–æ–±—ã—Ç–∏—è
            window.addEventListener('resize', setupCanvas);
            canvas.addEventListener('mousemove', handleMouseMove);
            canvas.addEventListener('mouseleave', handleMouseLeave);
            canvas.addEventListener('click', handleStarClick);
            
            // –î–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
            if ('ontouchstart' in window) {
                canvas.addEventListener('touchstart', handleTouchStart, { passive: true });
                canvas.addEventListener('touchmove', handleTouchMove, { passive: true });
                canvas.addEventListener('touchend', handleTouchEnd);
            }
            
            setupForm();
            setupStatsTabs();
            updateStats();
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
            setTimeout(() => {
                const loadingElement = document.getElementById('loading');
                if (loadingElement) {
                    loadingElement.style.display = 'none';
                }
                console.log('–ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é');
                animate();
            }, 1000);
            
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            const loadingElement = document.getElementById('loading');
            if (loadingElement) {
                loadingElement.innerHTML = '‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.<br><small>' + error.message + '</small>';
            }
        }
    }
    
    function setupCanvas() {
        try {
            const width = window.innerWidth;
            const height = window.innerHeight;
            
            // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
            if (width <= 0 || height <= 0) {
                console.warn('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –æ–∫–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É—é –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é');
                canvas.width = 800 * devicePixelRatio;
                canvas.height = 600 * devicePixelRatio;
                canvas.style.width = '800px';
                canvas.style.height = '600px';
            } else {
                canvas.width = width * devicePixelRatio;
                canvas.height = height * devicePixelRatio;
                canvas.style.width = width + 'px';
                canvas.style.height = height + 'px';
            }
            
            if (devicePixelRatio > 1) {
                ctx.scale(devicePixelRatio, devicePixelRatio);
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ setupCanvas:', error);
        }
    }
    
    function createStars(count) {
        try {
            const width = canvas.width / devicePixelRatio;
            const height = canvas.height / devicePixelRatio;
            
            // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –≤–∞–ª–∏–¥–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
            const safeWidth = Math.max(width, 100);
            const safeHeight = Math.max(height, 100);
            
            for (let i = 0; i < count; i++) {
                const size = Math.max(CONFIG.MIN_STAR_SIZE + Math.random() * (CONFIG.MAX_STAR_SIZE - CONFIG.MIN_STAR_SIZE), 0.5);
                
                stars.push({
                    id: i,
                    x: Math.random() * safeWidth,
                    y: Math.random() * safeHeight,
                    originalX: Math.random() * safeWidth,
                    originalY: Math.random() * safeHeight,
                    baseSize: size,
                    currentSize: size,
                    color: getRandomStarColor(),
                    speed: 0.02 + Math.random() * 0.05,
                    angle: Math.random() * Math.PI * 2,
                    pulse: Math.random() * Math.PI * 2,
                    pulseSpeed: 0.005 + Math.random() * 0.01,
                    glow: 0,
                    isHovered: false,
                    isUserStar: false,
                    isGoogleStar: false,
                    rotation: Math.random() * Math.PI * 2,
                    rotationSpeed: 0.0005 + Math.random() * 0.001
                });
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ createStars:', error);
        }
    }
    
    function getRandomStarColor() {
        try {
            const colors = Object.values(CONFIG.VALUE_COLORS);
            return colors[Math.floor(Math.random() * colors.length)] || '#ffffff';
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ getRandomStarColor:', error);
            return '#ffffff';
        }
    }
    
    function loadUserStars() {
        try {
            const width = canvas.width / devicePixelRatio;
            const height = canvas.height / devicePixelRatio;
            
            // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –≤–∞–ª–∏–¥–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
            const centerX = Math.max(width, 100) / 2;
            const centerY = Math.max(height, 100) / 2;
            
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∑–≤—ë–∑–¥—ã –ú–∞—Ç–≤–µ—è
            stars = stars.filter(star => !star.isMatvey);
            
            // –°–û–ó–î–ê–Å–ú –ó–í–ï–ó–î–£ –ú–ê–¢–í–ï–Ø –í –¶–ï–ù–¢–†–ï
            stars.push({
                id: 999,
                x: centerX,
                y: centerY,
                originalX: centerX,
                originalY: centerY,
                baseSize: 7,
                currentSize: 7,
                color: CONFIG.VALUE_COLORS['–£–≤–∞–∂–µ–Ω–∏–µ'] || '#ffdd00',
                name: "–ú–∞—Ç–≤–µ–π –õ–µ–≤—á–µ–Ω–∫–æ",
                class: "6 –∫–ª–∞—Å—Å",
                value: "–£–≤–∞–∂–µ–Ω–∏–µ",
                reason: "–£–≤–∞–∂–µ–Ω–∏–µ —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –¥–µ—Ä–∂–∏—Ç—Å—è –¥–æ–≤–µ—Ä–∏–µ –∏ –¥—Ä—É–∂–±–∞",
                speed: 0.01,
                angle: Math.random() * Math.PI * 2,
                pulse: Math.random() * Math.PI * 2,
                pulseSpeed: 0.003,
                glow: 2.0,
                isHovered: false,
                isUserStar: true,
                isMatvey: true,
                isGoogleStar: false,
                rotation: 0,
                rotationSpeed: 0.001 + Math.random() * 0.002
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∑–≤—ë–∑–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            if (Array.isArray(userStars)) {
                userStars.forEach((starData, index) => {
                    if (starData && starData.name !== "–ú–∞—Ç–≤–µ–π –õ–µ–≤—á–µ–Ω–∫–æ") {
                        addStarToGalaxy(starData, 1000 + index, false);
                    }
                });
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–≤–µ–∑–¥—É –ú–∞—Ç–≤–µ—è –≤ localStorage
            const hasMatveyStar = userStars.some(star => star && star.name === "–ú–∞—Ç–≤–µ–π –õ–µ–≤—á–µ–Ω–∫–æ");
            if (!hasMatveyStar) {
                userStars.unshift({
                    name: "–ú–∞—Ç–≤–µ–π –õ–µ–≤—á–µ–Ω–∫–æ",
                    class: "6",
                    value: "–£–≤–∞–∂–µ–Ω–∏–µ",
                    reason: "–£–≤–∞–∂–µ–Ω–∏–µ —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –¥–µ—Ä–∂–∏—Ç—Å—è –¥–æ–≤–µ—Ä–∏–µ –∏ –¥—Ä—É–∂–±–∞",
                    timestamp: new Date().toISOString(),
                    isMatvey: true
                });
                localStorage.setItem('gymnasiumValues', JSON.stringify(userStars));
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ loadUserStars:', error);
        }
    }
    
    function loadGoogleFormStars() {
        try {
            const width = canvas.width / devicePixelRatio;
            const height = canvas.height / devicePixelRatio;
            
            // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –≤–∞–ª–∏–¥–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
            const centerX = Math.max(width, 100) / 2;
            const centerY = Math.max(height, 100) / 2;
            
            // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –∑–≤—ë–∑–¥—ã –∏–∑ Google Forms
            stars = stars.filter(star => !star.isGoogleStar);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∑–≤—ë–∑–¥—ã –∏–∑ Google Forms
            if (Array.isArray(GOOGLE_FORM_DATA)) {
                GOOGLE_FORM_DATA.forEach((starData, index) => {
                    if (starData && starData.name) {
                        const googleStar = {
                            name: starData.name,
                            class: starData.class || "–ù–µ —É–∫–∞–∑–∞–Ω",
                            value: starData.value || "–ù–µ —É–∫–∞–∑–∞–Ω–∞",
                            reason: starData.reason || "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —É–∫–∞–∑–∞–ª –ø—Ä–∏—á–∏–Ω—É",
                            isGoogleStar: true
                        };
                        
                        googleFormStars.push(googleStar);
                        addStarToGalaxy(googleStar, 5000 + index, true);
                    }
                });
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ loadGoogleFormStars:', error);
        }
    }
    
    function addStarToGalaxy(starData, id, isGoogleStar) {
        try {
            const width = canvas.width / devicePixelRatio;
            const height = canvas.height / devicePixelRatio;
            
            // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –≤–∞–ª–∏–¥–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
            const centerX = Math.max(width, 100) / 2;
            const centerY = Math.max(height, 100) / 2;
            
            // –î–ª—è Google Forms –∑–≤—ë–∑–¥ –¥–µ–ª–∞–µ–º –∏—Ö –º–µ–Ω—å—à–µ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∞–ª—å—à–µ
            const size = Math.max(isGoogleStar ? (3 + Math.random() * 2) : (4 + Math.random() * 3), 0.5);
            
            // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –≤ —Ä–∞–∑–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
            let radius, angle;
            
            if (isGoogleStar) {
                // Google Forms –∑–≤—ë–∑–¥—ã - –¥–∞–ª—å—à–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞
                radius = 200 + Math.random() * Math.min(300, centerX - 50);
                angle = Math.random() * Math.PI * 2;
            } else {
                // –õ–∏—á–Ω—ã–µ –∑–≤—ë–∑–¥—ã - –±–ª–∏–∂–µ –∫ —Ü–µ–Ω—Ç—Ä—É
                radius = 100 + Math.random() * Math.min(200, centerX - 50);
                angle = Math.random() * Math.PI * 2;
            }
            
            const x = Math.min(Math.max(centerX + Math.cos(angle) * radius, 10), width - 10);
            const y = Math.min(Math.max(centerY + Math.sin(angle) * radius, 10), height - 10);
            
            // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Ü–≤–µ—Ç–∞
            let valueForColor = starData.value;
            if (valueForColor === "–î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç" || valueForColor === "–î–µ–Ω—å–≥–∏") {
                valueForColor = "–î—Ä—É–≥–æ–π";
            }
            
            stars.push({
                id: id,
                x: x,
                y: y,
                originalX: x,
                originalY: y,
                baseSize: size,
                currentSize: size,
                color: CONFIG.VALUE_COLORS[valueForColor] || CONFIG.VALUE_COLORS['–î—Ä—É–≥–æ–π'] || '#ffdd00',
                name: starData.name || "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",
                class: (starData.class || "?") + ' –∫–ª–∞—Å—Å',
                value: starData.value || "–ù–µ —É–∫–∞–∑–∞–Ω–∞",
                reason: starData.reason || "–ù–µ —É–∫–∞–∑–∞–Ω–æ",
                speed: 0.02 + Math.random() * 0.05,
                angle: Math.random() * Math.PI * 2,
                pulse: Math.random() * Math.PI * 2,
                pulseSpeed: 0.005 + Math.random() * 0.01,
                glow: isGoogleStar ? 0.5 : 1.0,
                isHovered: false,
                isUserStar: !isGoogleStar,
                isGoogleStar: isGoogleStar,
                isMatvey: starData.name === "–ú–∞—Ç–≤–µ–π –õ–µ–≤—á–µ–Ω–∫–æ",
                rotation: Math.random() * Math.PI * 2,
                rotationSpeed: 0.0005 + Math.random() * 0.001
            });
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ addStarToGalaxy:', error);
        }
    }
    
    function createBackgroundStars(count) {
        try {
            const width = canvas.width / devicePixelRatio;
            const height = canvas.height / devicePixelRatio;
            
            for (let i = 0; i < count; i++) {
                particles.push({
                    x: Math.random() * width,
                    y: Math.random() * height,
                    size: Math.random() * 1.5,
                    brightness: 0.1 + Math.random() * 0.6,
                    speed: 0.01 + Math.random() * 0.03
                });
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ createBackgroundStars:', error);
        }
    }
    
    function handleMouseMove(event) {
        try {
            const rect = canvas.getBoundingClientRect();
            const x = (event.clientX - rect.left) * (canvas.width / devicePixelRatio / Math.max(rect.width, 1));
            const y = (event.clientY - rect.top) * (canvas.height / devicePixelRatio / Math.max(rect.height, 1));
            
            if (hoveredStar) {
                hoveredStar.isHovered = false;
                hoveredStar.glow = getDefaultGlow(hoveredStar);
                hoveredStar = null;
            }
            
            tooltip.style.opacity = '0';
            
            let closestStar = null;
            let minDistance = Infinity;
            
            for (let star of stars) {
                const dx = x - star.x;
                const dy = y - star.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                const hoverRadius = star.currentSize * 15;
                
                if (distance < hoverRadius && distance < minDistance) {
                    minDistance = distance;
                    closestStar = star;
                }
            }
            
            if (closestStar) {
                closestStar.isHovered = true;
                closestStar.glow = getHoveredGlow(closestStar);
                hoveredStar = closestStar;
                
                showTooltip(closestStar, event.clientX, event.clientY);
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ handleMouseMove:', error);
        }
    }
    
    function getDefaultGlow(star) {
        try {
            if (star.isMatvey) return 2.0;
            if (star.isGoogleStar) return 0.5;
            if (star.isUserStar) return 1.0;
            return 0;
        } catch (error) {
            return 0;
        }
    }
    
    function getHoveredGlow(star) {
        try {
            if (star.isMatvey) return 3.0;
            if (star.isGoogleStar) return 2.0;
            if (star.isUserStar) return 2.0;
            return 1.0;
        } catch (error) {
            return 1.0;
        }
    }
    
    function handleTouchStart(event) {
        try {
            if (event.touches.length === 1) {
                const touch = event.touches[0];
                const rect = canvas.getBoundingClientRect();
                const x = (touch.clientX - rect.left) * (canvas.width / devicePixelRatio / Math.max(rect.width, 1));
                const y = (touch.clientY - rect.top) * (canvas.height / devicePixelRatio / Math.max(rect.height, 1));
                
                let closestStar = null;
                let minDistance = Infinity;
                
                for (let star of stars) {
                    const dx = x - star.x;
                    const dy = y - star.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    const hoverRadius = star.currentSize * 20;
                    
                    if (distance < hoverRadius && distance < minDistance) {
                        minDistance = distance;
                        closestStar = star;
                    }
                }
                
                if (closestStar) {
                    closestStar.isHovered = true;
                    closestStar.glow = getHoveredGlow(closestStar);
                    hoveredStar = closestStar;
                    
                    showTooltip(closestStar, touch.clientX, touch.clientY);
                    
                    // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –Ω–∞ 2 —Å–µ–∫—É–Ω–¥—ã
                    if (touchTimer) clearTimeout(touchTimer);
                    touchTimer = setTimeout(() => {
                        tooltip.style.opacity = '0';
                        if (hoveredStar) {
                            hoveredStar.isHovered = false;
                            hoveredStar.glow = getDefaultGlow(hoveredStar);
                            hoveredStar = null;
                        }
                    }, 2000);
                }
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ handleTouchStart:', error);
        }
    }
    
    function handleTouchMove(event) {
        try {
            if (event.touches.length === 1) {
                handleTouchStart(event);
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ handleTouchMove:', error);
        }
    }
    
    function handleTouchEnd() {
        try {
            if (touchTimer) clearTimeout(touchTimer);
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ handleTouchEnd:', error);
        }
    }
    
    function handleMouseLeave() {
        try {
            if (hoveredStar) {
                hoveredStar.isHovered = false;
                hoveredStar.glow = getDefaultGlow(hoveredStar);
                hoveredStar = null;
            }
            tooltip.style.opacity = '0';
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ handleMouseLeave:', error);
        }
    }
    
    function handleStarClick() {
        try {
            if (hoveredStar) {
                hoveredStar.glow = hoveredStar.isMatvey ? 4.0 : 3.0;
                setTimeout(() => {
                    if (hoveredStar) {
                        hoveredStar.glow = getDefaultGlow(hoveredStar);
                    }
                }, 300);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –µ—â—ë —Ä–∞–∑ –ø—Ä–∏ –∫–ª–∏–∫–µ
                showTooltip(hoveredStar, hoveredStar.x, hoveredStar.y);
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ handleStarClick:', error);
        }
    }
    
    // ‚≠ê‚≠ê‚≠ê –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–û–ö–ê–ó–ê –ü–û–î–°–ö–ê–ó–ö–ò ‚≠ê‚≠ê‚≠ê
    function showTooltip(star, clientX, clientY) {
        try {
            let sourceBadge = '';
            if (star.isGoogleStar) {
                sourceBadge = '<div style="color: #34a853; font-size: 11px; margin-bottom: 5px; font-weight: bold;">üåê Google –§–æ—Ä–º–∞</div>';
            } else if (star.isUserStar) {
                sourceBadge = '<div style="color: #ffdd00; font-size: 11px; margin-bottom: 5px; font-weight: bold;">‚≠ê –õ–∏—á–Ω–∞—è –∑–≤–µ–∑–¥–∞</div>';
            }
            
            tooltip.innerHTML = star.name ? `
                ${sourceBadge}
                <div class="star-name">‚≠ê ${star.name}</div>
                <div class="star-info"><strong>–ö–ª–∞—Å—Å:</strong> ${star.class}</div>
                <div class="star-info"><strong>–¶–µ–Ω–Ω–æ—Å—Ç—å:</strong> ${star.value}</div>
                <div class="star-info"><strong>–ü–æ—á–µ–º—É:</strong> ${star.reason}</div>
            ` : `
                <div class="star-name">‚ú® –ó–≤–µ–∑–¥–∞ –≥–∞–ª–∞–∫—Ç–∏–∫–∏</div>
                <div class="star-info">–ù–∞–∂–º–∏ "–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é –∑–≤–µ–∑–¥—É"!</div>
            `;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
            tooltip.style.opacity = '1';
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é —Å —É—á–µ—Ç–æ–º –≥—Ä–∞–Ω–∏—Ü —ç–∫—Ä–∞–Ω–∞
            const tooltipWidth = tooltip.offsetWidth;
            const tooltipHeight = tooltip.offsetHeight;
            
            // –ü–æ–∑–∏—Ü–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Å–ø—Ä–∞–≤–∞ —Å–Ω–∏–∑—É –æ—Ç –∫—É—Ä—Å–æ—Ä–∞)
            let x = clientX + 15;
            let y = clientY + 15;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–º–µ—â–∞–µ—Ç—Å—è –ª–∏ –ø–æ–¥—Å–∫–∞–∑–∫–∞ —Å–ø—Ä–∞–≤–∞
            if (x + tooltipWidth > window.innerWidth) {
                // –ù–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è —Å–ø—Ä–∞–≤–∞ - —Ä–∞–∑–º–µ—â–∞–µ–º —Å–ª–µ–≤–∞
                x = clientX - tooltipWidth - 15;
                if (x < 5) x = 5; // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø –æ—Ç –∫—Ä–∞—è
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–º–µ—â–∞–µ—Ç—Å—è –ª–∏ –ø–æ–¥—Å–∫–∞–∑–∫–∞ —Å–Ω–∏–∑—É
            if (y + tooltipHeight > window.innerHeight) {
                // –ù–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è —Å–Ω–∏–∑—É - —Ä–∞–∑–º–µ—â–∞–µ–º —Å–≤–µ—Ä—Ö—É
                y = clientY - tooltipHeight - 15;
                if (y < 5) y = 5; // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø –æ—Ç –∫—Ä–∞—è
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ–±—ã –ø–æ–¥—Å–∫–∞–∑–∫–∞ –Ω–µ –≤—ã—Ö–æ–¥–∏–ª–∞ –∑–∞ –≤–µ—Ä—Ö–Ω–∏–π –∫—Ä–∞–π
            if (y < 5) {
                y = 5;
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é
            tooltip.style.left = x + 'px';
            tooltip.style.top = y + 'px';
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ showTooltip:', error);
        }
    }
    
    // ‚≠ê‚≠ê‚≠ê –§–£–ù–ö–¶–ò–Ø –†–ò–°–û–í–ê–ù–ò–Ø –ü–Ø–¢–ò–ö–û–ù–ï–ß–ù–û–ô –ó–í–ï–ó–î–´ ‚≠ê‚≠ê‚≠ê
    function drawStar(star, time) {
        try {
            // –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            if (!star || typeof star.baseSize !== 'number') {
                return;
            }
            
            // –ü—É–ª—å—Å–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞
            star.pulse = (star.pulse || 0) + (star.pulseSpeed || 0.005);
            const pulseFactor = 0.8 + Math.sin(star.pulse) * 0.2;
            const size = Math.max((star.baseSize || 2) * pulseFactor, 0.5);
            
            // –í—Ä–∞—â–µ–Ω–∏–µ –∑–≤–µ–∑–¥—ã
            star.rotation = star.rotation || 0;
            star.rotationSpeed = star.rotationSpeed || 0.001;
            star.rotation += star.rotationSpeed;
            
            // 1. –†–∏—Å—É–µ–º –ü–£–õ–¨–°–ò–†–£–Æ–©–ï–ï –°–í–ï–ß–ï–ù–ò–ï –≤–æ–∫—Ä—É–≥ –∑–≤–µ–∑–¥—ã
            const glow = star.glow || 0;
            if (glow > 0) {
                const glowSize = size * (3 + glow * 2 + Math.sin(time * 0.5) * 0.5);
                const gradient = ctx.createRadialGradient(
                    star.x, star.y, 0,
                    star.x, star.y, glowSize
                );
                
                const color = star.color || '#ffffff';
                gradient.addColorStop(0, color + 'cc');
                gradient.addColorStop(0.4, color + '88');
                gradient.addColorStop(0.7, color + '44');
                gradient.addColorStop(1, color + '00');
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(star.x, star.y, glowSize, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // 2. –†–∏—Å—É–µ–º –ü–Ø–¢–ò–ö–û–ù–ï–ß–ù–£–Æ –ó–í–ï–ó–î–£
            ctx.save();
            ctx.translate(star.x, star.y);
            ctx.rotate(star.rotation);
            
            // –†–∞–∑–º–µ—Ä—ã –¥–ª—è –ø—è—Ç–∏–∫–æ–Ω–µ—á–Ω–æ–π –∑–≤–µ–∑–¥—ã
            const outerRadius = Math.max(size, 0.5);
            const innerRadius = Math.max(size * 0.4, 0.2);
            
            // –ì—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –∑–≤–µ–∑–¥—ã
            const starGradient = ctx.createRadialGradient(0, 0, 0, 0, 0, outerRadius);
            const color = star.color || '#ffffff';
            starGradient.addColorStop(0, color);
            starGradient.addColorStop(0.7, color);
            starGradient.addColorStop(1, color + 'aa');
            
            ctx.fillStyle = starGradient;
            ctx.beginPath();
            
            // –†–∏—Å—É–µ–º –ø—è—Ç–∏–∫–æ–Ω–µ—á–Ω—É—é –∑–≤–µ–∑–¥—É
            for (let i = 0; i < 10; i++) {
                const angle = star.rotation + (i * Math.PI) / 5;
                const radius = i % 2 === 0 ? outerRadius : innerRadius;
                const x = Math.cos(angle) * radius;
                const y = Math.sin(angle) * radius;
                
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            
            ctx.closePath();
            ctx.fill();
            
            // –û–±–≤–æ–¥–∫–∞ –∑–≤–µ–∑–¥—ã
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 0.8;
            ctx.stroke();
            
            // 3. –Ø—Ä–∫–∏–π —Ü–µ–Ω—Ç—Ä –∑–≤–µ–∑–¥—ã —Å –≤—Ä–∞—â–∞—é—â–∏–º—Å—è —ç—Ñ—Ñ–µ–∫—Ç–æ–º
            ctx.fillStyle = star.isMatvey ? '#ffff88' : '#ffffff';
            ctx.beginPath();
            ctx.arc(0, 0, size * 0.3, 0, Math.PI * 2);
            ctx.fill();
            
            // 4. –í—Ä–∞—â–∞—é—â–∏–π—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(0, 0, size * 0.15, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.restore();
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ drawStar:', error, star);
        }
    }
    
    function drawBackgroundStars() {
        try {
            const width = canvas.width / devicePixelRatio;
            const height = canvas.height / devicePixelRatio;
            
            particles.forEach(p => {
                p.x -= p.speed;
                if (p.x < -10) {
                    p.x = width + 10;
                    p.y = Math.random() * height;
                }
                
                // –ú–µ—Ä—Ü–∞–Ω–∏–µ
                const twinkle = 0.6 + Math.sin(Date.now() * 0.001 + p.x * 0.01) * 0.4;
                
                ctx.fillStyle = `rgba(255, 255, 255, ${p.brightness * twinkle})`;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
            });
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ drawBackgroundStars:', error);
        }
    }
    
    // –ì–∞—Ä–º–æ–Ω–∏—á–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –∑–≤—ë–∑–¥
    function animate() {
        try {
            const width = canvas.width / devicePixelRatio;
            const height = canvas.height / devicePixelRatio;
            const centerX = width / 2;
            const centerY = height / 2;
            const time = Date.now() * 0.001;
            
            // –û—á–∏—â–∞–µ–º canvas
            ctx.clearRect(0, 0, width, height);
            
            // –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
            const gradient = ctx.createLinearGradient(0, 0, 0, height);
            gradient.addColorStop(0, '#000010');
            gradient.addColorStop(0.5, '#0a0015');
            gradient.addColorStop(1, '#05000a');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, width, height);
            
            drawBackgroundStars();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –∑–≤—ë–∑–¥
            for (let star of stars) {
                if (!star) continue;
                
                // –ó–≤–µ–∑–¥–∞ –ú–∞—Ç–≤–µ—è - –ø–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –≤–æ–∫—Ä—É–≥ —Ü–µ–Ω—Ç—Ä–∞
                if (star.isMatvey) {
                    const orbitX = Math.cos(time * 0.1) * 30;
                    const orbitY = Math.sin(time * 0.13) * 20;
                    const waveX = Math.sin(time * 0.3) * 5;
                    const waveY = Math.cos(time * 0.2) * 5;
                    star.x = centerX + orbitX + waveX;
                    star.y = centerY + orbitY + waveY;
                }
                // –û—Å—Ç–∞–ª—å–Ω—ã–µ –∑–≤—ë–∑–¥—ã - –≤—Ä–∞—â–µ–Ω–∏–µ –≤–æ–∫—Ä—É–≥ —Ü–µ–Ω—Ç—Ä–∞ —Å —Ä–∞–∑–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é
                else {
                    const dx = (star.originalX || 0) - centerX;
                    const dy = (star.originalY || 0) - centerY;
                    const distance = Math.sqrt(dx*dx + dy*dy);
                    
                    const orbitSpeed = 0.1 / (distance / 150 + 1);
                    const angle = time * orbitSpeed + (star.id * 0.01);
                    
                    const currentDist = distance * (0.95 + Math.sin(time * 0.08 + star.id) * 0.05);
                    const orbitX = Math.cos(angle) * currentDist;
                    const orbitY = Math.sin(angle) * currentDist * 0.8;
                    
                    star.x = centerX + orbitX;
                    star.y = centerY + orbitY;
                }
                
                // –ü—É–ª—å—Å–∞—Ü–∏—è
                star.pulse = (star.pulse || 0) + (star.pulseSpeed || 0.005);
                
                drawStar(star, time);
            }
            
            animationFrameId = requestAnimationFrame(animate);
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ –∞–Ω–∏–º–∞—Ü–∏–∏:', error);
            // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
            if (animationFrameId) {
                cancelAnimationFrame(animationFrameId);
            }
            setTimeout(animate, 100);
        }
    }
    
    // –§—É–Ω–∫—Ü–∏–∏ —Ñ–æ—Ä–º—ã
    function setupForm() {
        try {
            const form = document.getElementById('starForm');
            const valueOptions = document.querySelectorAll('.value-option');
            const customValueInput = document.getElementById('customValue');
            const selectedValueInput = document.getElementById('selectedValue');
            const otherOption = document.getElementById('otherOption');
            
            if (!form || !valueOptions || !customValueInput || !selectedValueInput || !otherOption) {
                console.error('–ù–µ –Ω–∞–π–¥–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã');
                return;
            }
            
            valueOptions.forEach(option => {
                option.addEventListener('click', function() {
                    valueOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    if (this === otherOption) {
                        customValueInput.style.display = 'block';
                        selectedValueInput.value = '';
                        customValueInput.focus();
                    } else {
                        customValueInput.style.display = 'none';
                        selectedValueInput.value = this.dataset.value;
                    }
                });
            });
            
            customValueInput.addEventListener('input', function() {
                selectedValueInput.value = this.value;
                if (this.value.trim()) {
                    valueOptions.forEach(opt => opt.classList.remove('selected'));
                    otherOption.classList.add('selected');
                    customValueInput.style.display = 'block';
                }
            });
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = document.getElementById('studentName').value.trim();
                const studentClass = document.getElementById('studentClass').value;
                const value = selectedValueInput.value.trim();
                const reason = document.getElementById('valueReason').value.trim();
                
                if (!name || !studentClass || !value || !reason) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è!');
                    return;
                }
                
                const starData = {
                    name: name,
                    class: studentClass,
                    value: value,
                    reason: reason,
                    timestamp: new Date().toISOString()
                };
                
                if (!Array.isArray(userStars)) {
                    userStars = [];
                }
                
                userStars.push(starData);
                localStorage.setItem('gymnasiumValues', JSON.stringify(userStars));
                
                addStarToGalaxy(starData, 2000 + userStars.length, false);
                closeForm();
                updateStats();
                
                showNotification('–¢–≤–æ—è –∑–≤–µ–∑–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞! ‚ú®');
                form.reset();
                valueOptions.forEach(opt => opt.classList.remove('selected'));
                customValueInput.style.display = 'none';
                customValueInput.value = '';
                selectedValueInput.value = '';
            });
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ setupForm:', error);
        }
    }
    
    function setupStatsTabs() {
        try {
            const personalStatsBtn = document.getElementById('personalStatsBtn');
            const googleStatsBtn = document.getElementById('googleStatsBtn');
            const personalStats = document.getElementById('personalStats');
            const googleStats = document.getElementById('googleStats');
            
            if (!personalStatsBtn || !googleStatsBtn || !personalStats || !googleStats) {
                console.error('–ù–µ –Ω–∞–π–¥–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏');
                return;
            }
            
            personalStatsBtn.addEventListener('click', function() {
                personalStats.style.display = 'block';
                googleStats.style.display = 'none';
                personalStatsBtn.style.background = 'linear-gradient(145deg, rgba(80, 80, 120, 0.95), rgba(50, 50, 80, 0.98))';
                googleStatsBtn.style.background = 'linear-gradient(145deg, rgba(65, 105, 180, 0.7), rgba(45, 85, 160, 0.8))';
            });
            
            googleStatsBtn.addEventListener('click', function() {
                personalStats.style.display = 'none';
                googleStats.style.display = 'block';
                personalStatsBtn.style.background = 'linear-gradient(145deg, rgba(80, 80, 120, 0.7), rgba(50, 50, 80, 0.8))';
                googleStatsBtn.style.background = 'linear-gradient(145deg, rgba(65, 105, 180, 0.95), rgba(45, 85, 160, 0.98))';
                updateGoogleStats();
            });
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ setupStatsTabs:', error);
        }
    }
    
    function showNotification(message) {
        try {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(45deg, #32cd32, #00ced1);
                color: black;
                padding: 15px 25px;
                border-radius: 12px;
                font-weight: bold;
                z-index: 10001;
                box-shadow: 0 10px 30px rgba(50, 205, 50, 0.5);
                text-align: center;
                animation: fadeInOut 2s ease-in-out;
            `;
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fadeInOut {
                    0%, 100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
                    20%, 80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                }
            `;
            
            document.head.appendChild(style);
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 2000);
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ showNotification:', error);
        }
    }
    
    // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
    window.openForm = function() {
        try {
            document.getElementById('formOverlay').style.display = 'flex';
            const nameInput = document.getElementById('studentName');
            if (nameInput) nameInput.focus();
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ openForm:', error);
        }
    };
    
    window.closeForm = function() {
        try {
            document.getElementById('formOverlay').style.display = 'none';
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ closeForm:', error);
        }
    };
    
    window.openStats = function() {
        try {
            updateStats();
            updateGoogleStats();
            document.getElementById('statsOverlay').style.display = 'flex';
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ openStats:', error);
        }
    };
    
    window.closeStats = function() {
        try {
            document.getElementById('statsOverlay').style.display = 'none';
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ closeStats:', error);
        }
    };
    
    window.openInfo = function() {
        try {
            document.getElementById('infoOverlay').style.display = 'flex';
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ openInfo:', error);
        }
    };
    
    window.closeInfo = function() {
        try {
            document.getElementById('infoOverlay').style.display = 'none';
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ closeInfo:', error);
        }
    };
    
    // ‚≠ê‚≠ê‚≠ê –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê ‚≠ê‚≠ê‚≠ê
    function updateStats() {
        try {
            // –§–∏–ª—å—Ç—Ä—É–µ–º –∑–≤—ë–∑–¥—ã, –∏—Å–∫–ª—é—á–∞—è –ú–∞—Ç–≤–µ—è
            const myStars = userStars ? userStars.filter(star => star && !star.isMatvey) : [];
            
            // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–∏—Ö –∑–≤—ë–∑–¥
            const totalStarsElement = document.getElementById('totalStars');
            if (totalStarsElement) {
                totalStarsElement.textContent = myStars.length;
            }
            
            if (myStars.length > 0) {
                // –ú–æ–π –∫–ª–∞—Å—Å (–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–π –∑–≤–µ–∑–¥—ã)
                const lastStar = myStars[myStars.length - 1];
                const myClassElement = document.getElementById('myClass');
                if (myClassElement) {
                    myClassElement.textContent = (lastStar.class || "?") + ' –∫–ª–∞—Å—Å';
                }
                
                // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —á–∞—Å—Ç–æ—Ç—É —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
                const valueCount = {};
                myStars.forEach(star => {
                    const value = star.value || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                    valueCount[value] = (valueCount[value] || 0) + 1;
                });
                
                // –ù–∞—Ö–æ–¥–∏–º —Å–∞–º—É—é —á–∞—Å—Ç—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å (–≥–ª–∞–≤–Ω—É—é)
                let mainValue = '-';
                let maxCount = 0;
                for (const [value, count] of Object.entries(valueCount)) {
                    if (count > maxCount) {
                        maxCount = count;
                        mainValue = value;
                    }
                }
                const myMainValueElement = document.getElementById('myMainValue');
                if (myMainValueElement) {
                    myMainValueElement.textContent = mainValue.length > 10 ? mainValue.substring(0, 10) + '...' : mainValue;
                }
                
                // –ù–∞—Ö–æ–¥–∏–º —Å–∞–º—É—é –ø–æ–ø—É–ª—è—Ä–Ω—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö
                let popularValue = '-';
                let popularCount = 0;
                for (const [value, count] of Object.entries(valueCount)) {
                    if (count > popularCount) {
                        popularCount = count;
                        popularValue = value;
                    }
                }
                const popularValueElement = document.getElementById('popularValue');
                if (popularValueElement) {
                    popularValueElement.textContent = popularValue.length > 10 ? popularValue.substring(0, 10) + '...' : popularValue;
                }
                
                // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
                let distributionHTML = '';
                const sortedValues = Object.entries(valueCount)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 10); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ø-10
                
                if (sortedValues.length > 0) {
                    sortedValues.forEach(([value, count]) => {
                        const percentage = Math.round((count / myStars.length) * 100);
                        const color = CONFIG.VALUE_COLORS[value] || CONFIG.VALUE_COLORS['–î—Ä—É–≥–æ–π'] || '#ffdd00';
                        const displayValue = value.length > 15 ? value.substring(0, 15) + '...' : value;
                        distributionHTML += `
                            <div class="distribution-item">
                                <span style="min-width: 100px; color: ${color}; font-weight: bold;">${displayValue}</span>
                                <div style="flex: 1; height: 20px; background: rgba(255,255,255,0.1); border-radius: 10px; margin: 0 10px; overflow: hidden;">
                                    <div style="height: 100%; width: ${Math.max(5, percentage)}%; background: ${color}; border-radius: 10px;"></div>
                                </div>
                                <span style="min-width: 70px; text-align: right; color: #aaddff; font-weight: bold;">
                                    ${count} (${percentage}%)
                                </span>
                            </div>
                        `;
                    });
                } else {
                    distributionHTML = '<div style="color: #aaddff; text-align: center; padding: 20px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
                }
                
                const myValuesDistributionElement = document.getElementById('myValuesDistribution');
                if (myValuesDistributionElement) {
                    myValuesDistributionElement.innerHTML = distributionHTML;
                }
            } else {
                const myClassElement = document.getElementById('myClass');
                if (myClassElement) myClassElement.textContent = '-';
                
                const myMainValueElement = document.getElementById('myMainValue');
                if (myMainValueElement) myMainValueElement.textContent = '-';
                
                const popularValueElement = document.getElementById('popularValue');
                if (popularValueElement) popularValueElement.textContent = '-';
                
                const myValuesDistributionElement = document.getElementById('myValuesDistribution');
                if (myValuesDistributionElement) {
                    myValuesDistributionElement.innerHTML = 
                        '<div style="color: #aaddff; text-align: center; padding: 20px;">–£ —Ç–µ–±—è –ø–æ–∫–∞ –Ω–µ—Ç –∑–≤—ë–∑–¥. –î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é!</div>';
                }
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ updateStats:', error);
        }
    }
    
    // ‚≠ê‚≠ê‚≠ê –°–¢–ê–¢–ò–°–¢–ò–ö–ê GOOGLE FORMS ‚≠ê‚≠ê‚≠ê
    function updateGoogleStats() {
        try {
            // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤—ë–∑–¥ –∏–∑ Google Forms
            const totalGoogleStarsElement = document.getElementById('totalGoogleStars');
            if (totalGoogleStarsElement) {
                totalGoogleStarsElement.textContent = googleFormStars.length;
            }
            
            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
            const uniqueParticipants = new Set(googleFormStars.filter(star => star && star.name).map(star => star.name));
            const totalParticipantsElement = document.getElementById('totalParticipants');
            if (totalParticipantsElement) {
                totalParticipantsElement.textContent = uniqueParticipants.size;
            }
            
            if (googleFormStars.length > 0) {
                // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º
                const classCount = {};
                googleFormStars.forEach(star => {
                    if (star && star.class) {
                        const className = star.class + ' –∫–ª–∞—Å—Å';
                        classCount[className] = (classCount[className] || 0) + 1;
                    }
                });
                
                // –°–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –∫–ª–∞—Å—Å
                let popularClass = '-';
                let maxClassCount = 0;
                for (const [className, count] of Object.entries(classCount)) {
                    if (count > maxClassCount) {
                        maxClassCount = count;
                        popularClass = className;
                    }
                }
                const popularClassElement = document.getElementById('popularClass');
                if (popularClassElement) {
                    popularClassElement.textContent = popularClass;
                }
                
                // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
                let classDistributionHTML = '';
                const sortedClasses = Object.entries(classCount)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 8); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ø-8 –∫–ª–∞—Å—Å–æ–≤
                
                if (sortedClasses.length > 0) {
                    sortedClasses.forEach(([className, count]) => {
                        const percentage = Math.round((count / googleFormStars.length) * 100);
                        const color = getClassColor(className);
                        classDistributionHTML += `
                            <div class="distribution-item">
                                <span style="min-width: 80px; color: ${color}; font-weight: bold;">${className}</span>
                                <div style="flex: 1; height: 20px; background: rgba(255,255,255,0.1); border-radius: 10px; margin: 0 10px; overflow: hidden;">
                                    <div style="height: 100%; width: ${Math.max(5, percentage)}%; background: ${color}; border-radius: 10px;"></div>
                                </div>
                                <span style="min-width: 70px; text-align: right; color: #aaddff; font-weight: bold;">
                                    ${count} (${percentage}%)
                                </span>
                            </div>
                        `;
                    });
                } else {
                    classDistributionHTML = '<div style="color: #aaddff; text-align: center; padding: 20px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–ª–∞—Å—Å–∞–º</div>';
                }
                
                const classDistributionElement = document.getElementById('classDistribution');
                if (classDistributionElement) {
                    classDistributionElement.innerHTML = classDistributionHTML;
                }
                
                // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
                const valueCount = {};
                googleFormStars.forEach(star => {
                    if (star && star.value) {
                        let value = star.value;
                        // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
                        if (value === "–î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç") {
                            value = "–î—Ä—É–≥–æ–π";
                        }
                        valueCount[value] = (valueCount[value] || 0) + 1;
                    }
                });
                
                // –¢–æ–ø —Ü–µ–Ω–Ω–æ—Å—Ç—å
                let topValue = '-';
                let maxValueCount = 0;
                for (const [value, count] of Object.entries(valueCount)) {
                    if (count > maxValueCount) {
                        maxValueCount = count;
                        topValue = value;
                    }
                }
                const topGoogleValueElement = document.getElementById('topGoogleValue');
                if (topGoogleValueElement) {
                    topGoogleValueElement.textContent = topValue.length > 10 ? topValue.substring(0, 10) + '...' : topValue;
                }
                
                // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
                let googleValuesHTML = '';
                const sortedGoogleValues = Object.entries(valueCount)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 10); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ø-10 —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π
                
                if (sortedGoogleValues.length > 0) {
                    sortedGoogleValues.forEach(([value, count]) => {
                        const percentage = Math.round((count / googleFormStars.length) * 100);
                        const color = CONFIG.VALUE_COLORS[value] || CONFIG.VALUE_COLORS['–î—Ä—É–≥–æ–π'] || '#ffdd00';
                        const displayValue = value.length > 15 ? value.substring(0, 15) + '...' : value;
                        googleValuesHTML += `
                            <div class="distribution-item">
                                <span style="min-width: 100px; color: ${color}; font-weight: bold;">${displayValue}</span>
                                <div style="flex: 1; height: 20px; background: rgba(255,255,255,0.1); border-radius: 10px; margin: 0 10px; overflow: hidden;">
                                    <div style="height: 100%; width: ${Math.max(5, percentage)}%; background: ${color}; border-radius: 10px;"></div>
                                </div>
                                <span style="min-width: 70px; text-align: right; color: #aaddff; font-weight: bold;">
                                    ${count} (${percentage}%)
                                </span>
                            </div>
                        `;
                    });
                } else {
                    googleValuesHTML = '<div style="color: #aaddff; text-align: center; padding: 20px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ü–µ–Ω–Ω–æ—Å—Ç—è–º</div>';
                }
                
                const googleValuesDistributionElement = document.getElementById('googleValuesDistribution');
                if (googleValuesDistributionElement) {
                    googleValuesDistributionElement.innerHTML = googleValuesHTML;
                }
            } else {
                const popularClassElement = document.getElementById('popularClass');
                if (popularClassElement) popularClassElement.textContent = '-';
                
                const topGoogleValueElement = document.getElementById('topGoogleValue');
                if (topGoogleValueElement) topGoogleValueElement.textContent = '-';
                
                const classDistributionElement = document.getElementById('classDistribution');
                if (classDistributionElement) {
                    classDistributionElement.innerHTML = 
                        '<div style="color: #aaddff; text-align: center; padding: 20px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ Google Forms</div>';
                }
                
                const googleValuesDistributionElement = document.getElementById('googleValuesDistribution');
                if (googleValuesDistributionElement) {
                    googleValuesDistributionElement.innerHTML = 
                        '<div style="color: #aaddff; text-align: center; padding: 20px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ Google Forms</div>';
                }
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –≤ updateGoogleStats:', error);
        }
    }
    
    function getClassColor(className) {
        try {
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ü–≤–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–æ–º–µ—Ä–∞ –∫–ª–∞—Å—Å–∞
            const classNumber = parseInt(className) || 1;
            const hue = (classNumber * 30) % 360;
            return `hsl(${hue}, 70%, 60%)`;
        } catch (error) {
            return '#ffdd00';
        }
    }
    
    // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    window.addEventListener('load', init);
    
    // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Ä–∞–∑–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.addEventListener('beforeunload', function() {
        if (animationFrameId) {
            cancelAnimationFrame(animationFrameId);
        }
    });
</script>
